---
title: "28. Graphics for communication"
output: html_document
---

***

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
library(tidyverse)
```

### 28.2.1 Exercises

1. Create one plot on the fuel economy data with customised title, subtitle, caption, x, y, and colour labels.

```{r}
ggplot(mpg, aes(x = hwy, y = cty)) +
  geom_point(aes(colour = class)) +
  labs(
    title = "Small cars are more fuel efficient",
    subtitle = "SUVs have poor fuel economy",
    caption = "Data from fueleconomy.gov",
    x = "Highway miles per gallon",
    y = "City miles per gallon",
    colour = "Class"
  )
```

2. The `geom_smooth()` is somewhat misleading because the hwy for large engines is skewed upwards due to the inclusion of lightweight sports cars with big engines. Use your modelling tools to fit and display a better model.

3. Take an exploratory graphic that youâ€™ve created in the last month, and add informative titles to make it easier for others to understand.

```{r}
ggplot(iris, aes(x = Petal.Length, y = Petal.Width)) +
  geom_point(aes(colour = Species)) +
  labs(
    title = "Iris virginica and versicolor have large petals",
    subtitle = "Iris setosa have substantially smaller petals",
    caption = "Source: Edgar Anderson's Iris Data",
    x = "Petal length (cm)",
    y = "Petal width (cm)",
    colour = "Species of iris"
  )
```

### 28.3.1 Exercises

1. Use `geom_text()` with infinite positions to place text at the four corners of the plot.

```{r}
labels <- tibble(
  cty = c(Inf, Inf, -Inf, -Inf),
  displ = c(Inf, -Inf, Inf, -Inf),
  labels = c("Text", "tExt", "teXt", "texT"),
  vjust_var = c("top", "top", "bottom", "bottom"),
  hjust_var = c("right", "left", "right", "left")
)

ggplot(mpg, aes(x = displ, y = cty)) +
  geom_point(aes(colour = class)) +
  geom_text(data = labels, aes(label = labels, vjust = vjust_var, hjust = hjust_var))
```

2. Read the documentation for `annotate()`. How can you use it to add a text label to a plot without having to create a tibble?

```{r}
ggplot(mpg, aes(x = displ, y = cty)) +
  geom_point(aes(colour = class)) +
  annotate("text", x = 7, y = 35, label = "Text")
```

You can also easily add multiple labels:

```{r}
ggplot(mpg, aes(x = displ, y = cty)) +
  geom_point(aes(colour = class)) +
  annotate("text", x = c(7, 1), y = c(35, 35), label = c("Text", "tExt"))
```

3. How do labels with `geom_text()` interact with faceting? How can you add a label to a single facet? How can you put a different label in each facet? (Hint: think about the underlying data.)

4. What arguments to `geom_label()` control the appearance of the background box?

The `fill` aesthetic. For example:

```{r}
best_in_class <- mpg %>%
  group_by(class) %>%
  filter(row_number(desc(hwy)) == 1)

ggplot(mpg, aes(x = displ, y = cty)) +
  geom_point(aes(colour = class)) +
  geom_label(aes(label = model, fill = class), data = best_in_class)
```

5. What are the four arguments to `arrow()`? How do they work? Create a series of plots that demonstrate the most important options.

The four arguments to `arrow()` are angle, length, ends, and type. `geom_segment` has an arrow argument.