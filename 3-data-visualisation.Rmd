---
title: "3. Data visualisation"
output: html_document
---

***

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
library(tidyverse)
``` 

### 3.2.4 Exercises

1. Run `ggplot(data = mpg)`. What do you see?

```{r}
ggplot(data = mpg)
```

Nothing. No layers have been added to `ggplot()`.

2. How many rows are in `mpg`? How many columns?

234 rows and 11 columns in total.

```{r}
mpg
```

3. What does the `drv` variable describe? Read the help for `?mpg` to find out.

`drv` describes whether the car is front-wheel drive, rear wheel drive, or 4wd.

4. Make a scatterplot of `hwy` vs `cyl`.

```{r}
ggplot(mpg, aes(x = hwy, y = cyl)) +
  geom_point()
```

5. What happens if you make a scatterplot of `class` vs `drv`? Why is the plot not useful?

```{r}
ggplot(mpg, aes(x = class, y = drv)) +
  geom_point()
```

Scatterplots are suitable for displaying continuous variables (e.g., `cty` and `hwy`). `class` and `drv` are discrete variables.

### 3.3.1 Exercises

1. What’s gone wrong with this code? Why are the points not blue?

```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, color = "blue"))
```

In this example, colour has been mapped to an aesthetic. However, "blue" is not a variable in the dataset. To make the points blue, colour must be set manually (i.e., it must be located *outside* `aes()`:


```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy), color = "blue")
```

3. Which variables in `mpg` are categorical? Which variables are continuous? (Hint: type `?mpg` to read the documentation for the dataset). How can you see this information when you run `mpg?`

```{r}
mpg
```

Categorical: `manufacturer`, `model`, `trans`, `drv`, `fl`, `class`  
Continuous: `displ`, `year`, `cty`, `hwy`

This information is located below the variable name in the output (e.g., `<chr>`).

4. What happens if you map the same variable to multiple aesthetics?

```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, colour = displ))
```

It creates a gradient along whichever axis the variable is assigned to.

5. What does the `stroke` aesthetic do? What shapes does it work with? (Hint: use `?geom_point`)

`stroke` increases the border width of shapes. However, not all shapes have a border.

```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy), stroke = 2, shape = 23)
```

6. What happens if you map an aesthetic to something other than a variable name, like `aes(colour = displ < 5)`?

```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, colour = displ < 5))
```
  
In this example, the argument is evaluated and two additional groups are formed. This is displayed in addition to the `x` and `y` variables.

### 3.5.1 Exercises

1. What happens if you facet on a continuous variable?

Each value of the continuous variable will be treated as a discrete category. This can result in a very large output!

```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_wrap(~ cty, nrow = 2)
```

2. What do the empty cells in plot with `facet_grid(drv ~ cyl)` mean? How do they relate to this plot?

It means there are no four-wheel drive or rear-wheel drive cars with 5 cylinders. Also, there are no rear-wheel drive cars with 4 cylinders.

The plot below shows the same thing but displays it in one plot.

```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = drv, y = cyl))
```

3. What plots does the following code make? What does `.` do?

```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) +
  facet_grid(drv ~ .)
```

```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) +
  facet_grid(. ~ cyl)
```

`.` is used when you do not want to facet in a row or column.

4. Take the first faceted plot in this section:

```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_wrap(~ class, nrow = 2)
```

What are the advantages to using faceting instead of the colour aesthetic? What are the disadvantages? How might the balance change if you had a larger dataset?

Faceting is helpful when there are many data points and/or groups. When combined into one plot, it is more difficult to discern between these groups:

```{r}
ggplot(mpg, aes(x = displ, y = hwy, colour = class)) +
  geom_point()
```

It also makes it easier to compare the groups when faceting is used.

5. Read `?facet_wrap`. What does `nrow` do? What does `ncol` do? What other options control the layout of the individual panels? Why doesn’t `facet_grid()` have `nrow` and `ncol` argument?

`nrow` and `ncol` lets you specify the number of rows and columns to display when faceting. `dir` is an example of an option that controls the layout of panels. `facet_grid()` does not have `nrow` and `ncol` arguments because it facets in a combination of two variables.

6. When using `facet_grid()` you should usually put the variable with more unique levels in the columns. Why?

This might have something to do with the output.

### 3.6.1 Exercises

1. What geom would you use to draw a line chart? A boxplot? A histogram? An area chart?

`geom_line`, `geom_boxplot`, `geom_histogram`, and `geom_area`.

2. Run this code in your head and predict what the output will look like. Then, run the code in R and check your predictions.

```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy, color = drv)) + 
  geom_point() + 
  geom_smooth(se = FALSE)
```

(There are three separate lines because the global mappings are also passed onto `geom_smooth`.)

3. What does show.legend = FALSE do? What happens if you remove it? Why do you think I used it earlier in the chapter?

```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(color = class), show.legend = FALSE) + 
  geom_smooth()
```

`show.legend = FALSE` removes the legend from the plot for `class`. If you remove `show.legend`, the legend appears in the plot. This is because `show.legend` is `NA` by default for `geom_point` (see `?geom_point`).

4. What does the `se` argument to `geom_smooth()` do?

It displays the confidence interval around `smooth` (this is `TRUE` by default).

`level` allows you to specify the level of the confidence interval to use (e.g., 0.95).

5. Will these two graphs look different? Why/why not?

```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point() + 
  geom_smooth()

ggplot() + 
  geom_point(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_smooth(data = mpg, mapping = aes(x = displ, y = hwy))
```

No, both will look the same because they use the same mappings. In the first example, the mappings are specified at the global level. In the second example, the mappings are specified at the local level.

6. Recreate the R code necessary to generate the following graphs.

```{r}
ggplot(mpg, aes(x = displ, y = hwy)) +
  geom_point(size = 3) +
  geom_smooth(se = FALSE)
```

```{r}
ggplot(mpg, aes(x = displ, y = hwy)) +
  geom_point(size = 3) +
  geom_smooth(aes(group = drv), se = FALSE)
```

```{r}
ggplot(mpg, aes(x = displ, y = hwy, colour = drv)) +
  geom_point(size = 3) +
  geom_smooth(se = FALSE)
```

```{r}
ggplot(mpg, aes(x = displ, y = hwy)) +
  geom_point(aes(colour = drv), size = 3) +
  geom_smooth(se = FALSE)
```

```{r}
ggplot(mpg, aes(x = displ, y = hwy)) +
  geom_point(aes(colour = drv), size = 3) +
  geom_smooth(aes(linetype = drv), se = FALSE)
```

```{r}
ggplot(mpg, aes(x = displ, y = hwy, fill = drv)) +
  geom_point(shape = 21, colour = "white", size = 3, stroke = 3)
```